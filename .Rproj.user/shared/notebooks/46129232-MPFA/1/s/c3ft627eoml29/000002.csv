"0","# Total fund size, grouped by MPF provider"
"0","MPFA_market_share = MPFA %>% group_by(`MPF Trustee`) %>%"
"0","  summarise(`Constituent Fund` = n(),"
"0","            `Total Fund size (HKD' m)` = sum(`Fund size (HKD' m)`))"
"0","# Adding more columns"
"0","MPFA_market_share = MPFA_market_share %>% mutate("
"0","  Proportion = `Total Fund size (HKD' m)` / sum(`Total Fund size (HKD' m)`),"
"0","  ""Average Fund size (HKD' m)"" = `Total Fund size (HKD' m)` / `Constituent Fund`"
"0",")"
"0",""
"0","# Pie chart to show market share"
"0","library(viridis)"
"0","library(scales)"
"0",""
"0","bar_total_size = ggplot(MPFA_market_share,"
"0","                        aes(x = reorder(`MPF Trustee`, desc(`Total Fund size (HKD' m)`)), y = `Total Fund size (HKD' m)`,"
"0","                            fill = `MPF Trustee`)) +"
"0","  geom_bar(stat = ""identity"") +"
"0","  scale_fill_viridis(discrete=TRUE) +"
"0","  labs(x = ""MPF Trustee"", title = ""Total Fund Size"") +"
"0","  scale_y_continuous(labels = dollar) +"
"0","  theme(axis.text.x = element_text(angle=90, hjust=1))"
"0",""
"0","bar_average_size = ggplot(MPFA_market_share,"
"0","                          aes(x = reorder(`MPF Trustee`, desc(`Average Fund size (HKD' m)`)), y = `Average Fund size (HKD' m)`,"
"0","                              fill = `MPF Trustee`)) +"
"0","  geom_bar(stat = ""identity"") +"
"0","  scale_fill_viridis(discrete=TRUE) +"
"0","  labs(x = ""MPF Trustee"", title = ""Average Fund Size"") +"
"0","  scale_y_continuous(labels = dollar) +"
"0","  theme(axis.text.x = element_text(angle=90, hjust=1))"
